<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recuperar Contraseña</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f2f2f2;
        }
        .container {
            width: 300px;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h2 {
            margin-top: 0;
            text-align: center;
        }
        label {
            display: block;
            margin-bottom: 8px;
        }
        input[type="email"] {
            width: 100%;
            padding: 8px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        input[type="submit"] {
            width: 100%;
            padding: 10px;
            background-color: #007bff;
            border: none;
            border-radius: 4px;
            color: #fff;
            cursor: pointer;
        }
        input[type="submit"]:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Recuperar Contraseña</h2>
		<form id="recoveryForm" action="procesar_recuperacion.php" method="post">
            <label for="email">Correo Electrónico:</label>
            <input type="email" id="email" name="email" required>
            <input type="submit" value="Enviar Correo de Recuperación">
        </form>
    </div>
	
	<script>
	document.addEventListener("DOMContentLoaded", function() {
	  document.getElementById("recoveryForm").addEventListener("submit", function(event) {
	    event.preventDefault(); // Evitar que el formulario se envíe automáticamente
	
	    var formData = new FormData(this); // Obtener datos del formulario
	    var xhr = new XMLHttpRequest(); // Crear una nueva solicitud HTTP
	
	    // Configurar la solicitud
	    xhr.open("POST", this.action, true);
	    xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
	
	    // Manejar la respuesta de la solicitud
	    xhr.onload = function() {
	      if (xhr.status === 200) {
	        // Aquí puedes agregar código para manejar la respuesta del servidor
	        // Por ejemplo, mostrar un mensaje de éxito al usuario
	        alert("Correo de recuperación enviado correctamente");
	      } else {
	        // En caso de error, mostrar un mensaje de error al usuario
	        alert("Error al enviar el correo de recuperación");
	      }
	    };
	
	    // Enviar la solicitud con los datos del formulario
	    xhr.send(new URLSearchParams(new FormData(this)));
	  });
	});
	// Asegúrate de haber habilitado la API de Gmail en la consola de desarrolladores de Google y haber creado credenciales de autenticación.
	
	// Función para enviar un correo electrónico
	function enviarCorreo(recipient, subject, body) {
	  // Carga la librería de Gmail API
	  gapi.client.load('gmail', 'v1', function() {
	    // Construye el mensaje en formato MIME
	    var email = '';
	    email += 'To: ' + recipient + '\r\n';
	    email += 'Subject: ' + subject + '\r\n';
	    email += 'Content-Type: text/html; charset=utf-8\r\n\r\n';
	    email += body + '\r\n';
	    var base64EncodedEmail = btoa(email);
	
	    // Envía el mensaje
	    var request = gapi.client.gmail.users.messages.send({
	      'userId': 'me',
	      'resource': {
	        'raw': base64EncodedEmail
	      }
	    });
	    request.execute(function(response) {
	      console.log(response);
	      // Aquí puedes manejar la respuesta de la API de Gmail
	    });
	  });
	}
	
	// Evento click para el botón de enviar correo de recuperación
	document.getElementById('enviar-correo').addEventListener('click', function(event) {
	  event.preventDefault();
	  var email = document.getElementById('email').value;
	  var subject = 'Recuperación de contraseña';
	  var body = 'Aquí va tu mensaje de recuperación de contraseña. Puedes incluir un enlace personalizado para restablecer la contraseña.';
	  enviarCorreo(email, subject, body);
	});
	</script>

</body>
</html>
